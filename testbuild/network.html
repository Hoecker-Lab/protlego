<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Drawing networks &mdash; ProtLego 1.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building chimeras" href="building.html" />
    <link rel="prev" title="Fetching from the Fuzzle database" href="fetching.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ProtLego
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="builder.html">Building Chimeras</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder.html#module-builder.chimera">Chimera Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Fetching hits from Fuzzle</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="energy.html">Energy scoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyse.html">Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyse.html#module-structural.hh_networks">HH-networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyse.html#module-structural.salt_bridges">Salt-bridges</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyse.html#module-structural.analysis">Further structural analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#pip-installation">PIP installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#conda-installation">CONDA installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#setup">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#installing-from-environment-file">Installing from environment file</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="fuzzle.html">Visit Fuzzle</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to Jupyter-notebooks and Python primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetching.html">Fetching from the Fuzzle database</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Drawing networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#1.-Drawing-relationships-between-two-superfamilies">1. Drawing relationships between two superfamilies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building chimeras</a></li>
<li class="toctree-l1"><a class="reference internal" href="structural.html">Structural analysis of chimeras</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ProtLego</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Drawing networks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/network.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="Drawing-networks">
<h1>Drawing networks<a class="headerlink" href="#Drawing-networks" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">protlego.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<p>Besides retrieving hits, usually we might one to have a look at the fragments in their structural context, or visualize the protein space via network representations. We will cover that in this tutorial.</p>
<div class="section" id="1.-Drawing-relationships-between-two-superfamilies">
<h2>1. Drawing relationships between two superfamilies<a class="headerlink" href="#1.-Drawing-relationships-between-two-superfamilies" title="Permalink to this heading"></a></h2>
<p>In the previous tutorial, we built chimeras between a Rossmann and a P-loop domain. In this tutorial we are going to represent the relationships between these two folds. We will focus on two superfamilies of the folds:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hits</span><span class="o">=</span><span class="n">fetch_group</span><span class="p">(</span><span class="s1">&#39;c.37.1&#39;</span><span class="p">,</span><span class="s1">&#39;c.2.1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>First create an instance of the network class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">Network</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, create a graph for this selection. We use the package graph-tool. If you want, you can have a look at the graph-tool documentation here <a class="reference external" href="https://graph-tool.skewed.de">https://graph-tool.skewed.de</a>)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">create_network</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now, let’s draw the graph with the plot_graph() function, set as first parameter the network and as second parameter the coloring method, for example coloring by folds. P-loops will be shown in green and Rossmann fold proteins in blue.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="s1">&#39;fold&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/network_11_0.png" src="_images/network_11_0.png" />
</div>
</div>
<p>We can extract some information about this network. For example, the total number of different fragments (subgraphfs or components) that these hits contain.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frag</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">fragments</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
There are  17  fragments
</pre></div></div>
</div>
<p>To see the hits within the network:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">hits</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Query from Fuzzle with 1737 hits belonging to 2 fold(s)
</pre></div></div>
</div>
<p>With the function vertex_of_fragment one can get a list of all the vertices within the respective component of the network.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">vertex_of_fragment</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0,
 1,
 2,
 3,
 4,
 5,
 6,
 7,
 8,
 9,
 10,
 11,
 12,
 13,
 14,
 15,
 16,
 17,
 25,
 26,
 27,
 28,
 29,
 30,
 31,
 32,
 33,
 34,
 35,
 36,
 37,
 38,
 39,
 40,
 41,
 42,
 43,
 44,
 45,
 46,
 47,
 48,
 49,
 50,
 51,
 52,
 53,
 54,
 55,
 56,
 57,
 58,
 59,
 60,
 61,
 62,
 63,
 64,
 65,
 66,
 67,
 68,
 69,
 70,
 71,
 72,
 73,
 74,
 75,
 76,
 77,
 78,
 79,
 80,
 81,
 82,
 83,
 84,
 85,
 86,
 87,
 88,
 89,
 90,
 91,
 92,
 93,
 94,
 95,
 96,
 97,
 98,
 99,
 100,
 101,
 102,
 103,
 104,
 105,
 106,
 107,
 108,
 109,
 110,
 111,
 112,
 113,
 114,
 115,
 116,
 117,
 118,
 119,
 120,
 121,
 122,
 123,
 124,
 125,
 126,
 127,
 128,
 129,
 130,
 131,
 132,
 133,
 134,
 135,
 136,
 137,
 138,
 139,
 140,
 141,
 142,
 143,
 144,
 145,
 146,
 147,
 148,
 149,
 150,
 151,
 152,
 153,
 154,
 155,
 156,
 157,
 158,
 159,
 160,
 161,
 162,
 163,
 164,
 165,
 166,
 167,
 168,
 169,
 170,
 171,
 172,
 173,
 177,
 178,
 179,
 180,
 181,
 182,
 188,
 189,
 190,
 191,
 192,
 193,
 194,
 195,
 196,
 197,
 198,
 199,
 200,
 201,
 202,
 203,
 204,
 205,
 207,
 208,
 210,
 211,
 212,
 213,
 214,
 215,
 216,
 217,
 218,
 219,
 220,
 221,
 222,
 224,
 225,
 227,
 228,
 229,
 230,
 232,
 233,
 234,
 235,
 236,
 237,
 238,
 239,
 240,
 241,
 242,
 243,
 244,
 245,
 246,
 247,
 248,
 249,
 250,
 251,
 252,
 253,
 256,
 257,
 258,
 259,
 260,
 261,
 262,
 263,
 264,
 265,
 266,
 267,
 268,
 269,
 270,
 271,
 272,
 273,
 274,
 275,
 276,
 277,
 278,
 283,
 284,
 285,
 286,
 287,
 288,
 289,
 290,
 291,
 292,
 293,
 294,
 300,
 301,
 303,
 304,
 305,
 306,
 307,
 308,
 309,
 310,
 311,
 314,
 315,
 316,
 317,
 318,
 319,
 320,
 321,
 322,
 323,
 324,
 325,
 334,
 368,
 369,
 370,
 371,
 372,
 373,
 374,
 375,
 376,
 377,
 378,
 379,
 381,
 383,
 384,
 385,
 386,
 387,
 388,
 389,
 390,
 391,
 392,
 393,
 394,
 395,
 396,
 397,
 398,
 399,
 400,
 401,
 402,
 403,
 413,
 414,
 415,
 416,
 417,
 418,
 419,
 420,
 421,
 422,
 424,
 425,
 426,
 427,
 430,
 431,
 434,
 435,
 436,
 437,
 438,
 439,
 440,
 441,
 447,
 448,
 451,
 452,
 453,
 454,
 456,
 457,
 458,
 459]
</pre></div></div>
</div>
<p>The function show_vertex can be used to show the structure of a vertex in the network. To get a vertex use the graph.vertex function. The part of the protein that is shared with the other vertices connected to the vertex is shown in red. The rest of the protein is shown in white.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vertex</span><span class="o">=</span><span class="n">graph</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">63</span><span class="p">)</span>
<span class="n">mol</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">show_vertex</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-12 14:54:20,556 - protlego - INFO - Attempting to download domain d2hjra1 from the SCOP server
2020-10-12 14:54:21,742 - protlego - INFO - File downloaded as /tmp/tmptf5zir12.pdb
</pre></div></div>
</div>
<p>We can have a look at all the edges that this vertex has. That is, how many other vertices this protein is linked to and who they are.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">vertex</span><span class="o">.</span><span class="n">all_edges</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">source</span><span class="p">(),</span><span class="n">edge</span><span class="o">.</span><span class="n">target</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
63 179
63 284
63 43
</pre></div></div>
</div>
<p>Vertex number 63 is connected to another three vertices. We can also print the domain names and the folds they belong to:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">vertex</span><span class="o">.</span><span class="n">all_edges</span><span class="p">():</span>
    <span class="n">source</span><span class="o">=</span><span class="n">edge</span><span class="o">.</span><span class="n">source</span><span class="p">()</span>
    <span class="n">target</span><span class="o">=</span><span class="n">edge</span><span class="o">.</span><span class="n">target</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="o">.</span><span class="n">domain</span><span class="p">[</span><span class="n">source</span><span class="p">],</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="o">.</span><span class="n">fold</span><span class="p">[</span><span class="n">source</span><span class="p">],</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="o">.</span><span class="n">domain</span><span class="p">[</span><span class="n">target</span><span class="p">],</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="o">.</span><span class="n">fold</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
d2hjra1 c.2 d2afhe_ c.37
d2hjra1 c.2 d1lw7a2 c.37
d2hjra1 c.2 d1cp2a_ c.37
</pre></div></div>
</div>
<p>To visualize the superimposition that one edge represents, can use the show_edges() function. To get an edge use the graph.edge function which needs the two vertices as parameters. The proteins get superimposed and the fragments of the two proteins that produce the hit are colored in red, the rest of the proteins is colored in white.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge</span><span class="o">=</span><span class="n">graph</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span><span class="mi">179</span><span class="p">)</span>
<span class="n">mol1</span><span class="p">,</span><span class="n">mol2</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">show_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-12 14:55:08,464 - protlego - INFO - Attempting to download domain d2hjra1 from the SCOP server
2020-10-12 14:55:09,462 - protlego - INFO - File downloaded as /tmp/tmphpnm2jlq.pdb
2020-10-12 14:55:09,463 - protlego - INFO - Attempting to download domain d2afhe_ from the SCOP server
2020-10-12 14:55:10,809 - protlego - INFO - File downloaded as /tmp/tmp3jfcs8am.pdb
2020-10-12 14:55:10,811 - protlego - INFO - Loading /tmp/tmphpnm2jlq.pdb as a chimera object
2020-10-12 14:55:10,894 - protlego - INFO - Loading /tmp/tmp3jfcs8am.pdb as a chimera object
2020-10-12 14:55:10,969 - protlego - INFO - Attempting to download hhs file for d2hjra1 from the FUZZLE server
2020-10-12 14:55:11,287 - protlego - INFO - File downloaded as /tmp/tmps87c1p8u.hhs
2020-10-12 14:55:12,445 - protlego - INFO - Performing alignment 1 with TMalign
2020-10-12 14:55:15,704 - protlego - INFO - The RMSD between the fragments is 4.795979022979736 over 35 alpha carbons
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
d2hjra1 d2afhe_ 13 49 2 41
</pre></div></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fetching.html" class="btn btn-neutral float-left" title="Fetching from the Fuzzle database" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="building.html" class="btn btn-neutral float-right" title="Building chimeras" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Noelia Ferruz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>